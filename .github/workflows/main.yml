name: 'Terraform Deployment'
on:
  push:
    branches: ["main"]
  workflow_dispatch:  
jobs:
  Terraform:
  name: 'Terraform'
  runs-on: ubuntu-latest
  environment: production
  defaults:
      run:
        shell: bash
  steps:      
     - name: Obtendo o c√≥digo
       uses: actions/checkout@v4.1.5

     - name: 'Setup terraform'
       uses: hashicorp/setup-terraform@v3
       with:
         terraform_version: "4.7.0"

     - name: Azure Login
       uses: azure/login@v2
       with:
        creds: ${{ secrets.AZURE_CREDENTIALS }} 

     #- name: Azure CLI script
     #   uses: azure/cli@v2
     #   with:
     #     azcliversion: latest
     #     inlineScript: |
     #       az account show

     - name: Terraform Init
       run: terraform init

     - name: Terraform Plan
       run: terraform plan -var-file dev.tfvars

     - name: Terraform Apply
       run: terraform apply -var-file dev.tfvars

            

     
    
  
  
